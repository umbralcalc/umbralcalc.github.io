<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="description" content="umbralcalculations - Visual explorations in computation, science and creative writing" />
  <meta name="keywords" content="computation, science, creative writing, simulation, data" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="../assets/umbralcalculations-logo.svg">
  <link rel="icon" type="image/x-icon" href="../assets/favicon.ico">
  <link rel="apple-touch-icon" href="../assets/umbralcalculations-logo.svg">
  
  <title>Substitution timing of rugby managers</title>
  
  <!-- Fonts -->
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Open+Sans:wght@300;400;600&display=swap');
  </style>
  
  <!-- Prism.js for syntax highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-vs.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-go.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-shell-session.min.js"></script>
  
  <!-- Custom CSS -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Open Sans', sans-serif;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
      padding: 0;
      margin: 0;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
      background: #fff;
      min-height: 100vh;
    }

    nav {
      margin-bottom: 3rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid #e0e0e0;
      white-space: nowrap;
    }

    nav a {
      color: #2c3e50;
      text-decoration: none;
      font-weight: 600;
      margin-right: 2rem;
      transition: color 0.3s;
      font-size: 1.1rem;
      display: inline-block;
    }

    nav a:hover {
      color: #b0447aff;
      text-decoration: none;
    }

    /* Typography */
    h1, h2, h3, h4, h5, h6 {
      font-family: 'Merriweather', serif;
      color: #1a1a1a;
      margin-top: 1.5rem;
      margin-bottom: 0.75rem;
      line-height: 1.3;
    }

    h1 {
      font-size: 2rem;
      color: #1a1a1a;
      margin-bottom: 0.5rem;
      border-bottom: 3px solid #2c3e50;
      padding-bottom: 0.3rem;
      margin-top: 0;
    }

    h2 {
      font-size: 1.8rem;
      color: #2c3e50;
      margin-top: 2rem;
      margin-bottom: 0.75rem;
      border-bottom: 2px solid #3c78d8ff;
      padding-bottom: 0.3rem;
    }

    h3 {
      font-size: 1.4rem;
      color: #2c3e50;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    h4 {
      font-size: 1.2rem;
      color: #2c3e50;
      margin-top: 1.2rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    h5, h6 {
      font-size: 1.1rem;
      color: #2c3e50;
      margin-top: 1rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    p {
      margin-bottom: 1rem;
      color: #333;
      line-height: 1.7;
    }

    a {
      color: #3c78d8ff;
      text-decoration: none;
      transition: color 0.2s ease;
    }

    a:hover {
      color: #3c78d8ff;
      text-decoration: underline;
    }

    hr {
      border: none;
      border-top: 1px solid #ddd;
      margin: 2rem 0;
    }

    /* Code blocks */
    pre {
      background-color: #1e1e1e;
      color: #d4d4d4;
      padding: 1.5rem;
      border-radius: 0;
      overflow-x: auto;
      margin: 1.5rem 0;
      font-size: 0.875rem;
      line-height: 1.5;
      border: 1px solid #e0e0e0;
    }

    code {
      background-color: #f1f5f9;
      color: #333;
      padding: 0.125rem 0.375rem;
      border-radius: 0;
      font-size: 0.875rem;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'Courier New', monospace;
    }

    pre code {
      background-color: transparent;
      color: inherit;
      padding: 0;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'Courier New', monospace;
    }

    /* Lists */
    ul, ol {
      margin-bottom: 1rem;
      margin-left: 1.5rem;
    }

    li {
      margin-bottom: 0.5rem;
      color: #333;
      line-height: 1.6;
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1.5rem 0;
      background-color: #fff;
      border-radius: 0;
      overflow: hidden;
    }

    th, td {
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
    }

    th {
      background-color: #f8f9fa;
      font-weight: 600;
      color: #2c3e50;
    }

    /* Blockquotes */
    blockquote {
      border-left: 4px solid #3c78d8ff;
      padding-left: 1rem;
      margin: 1.5rem 0;
      color: #555;
      font-style: italic;
    }

    /* Images */
    img {
      max-width: 100%;
      height: auto;
      border-radius: 0;
      margin: 1.5rem 0;
    }

    /* Math */
    .math {
      overflow-x: auto;
      overflow-y: hidden;
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .container {
        padding: 1.5rem;
      }

      h1 {
        font-size: 1.8rem;
      }

      h2 {
        font-size: 1.5rem;
      }

      nav a {
        margin-right: 1.5rem;
        font-size: 1rem;
      }
      
      .series-hero {
        flex-direction: column;
        align-items: flex-start;
      }

      .series-cover {
        width: 100%;
        align-self: flex-start;
      }

      .post-images img {
        height: 96px;
      }
    }

    /* Series navigation */
    .series-nav {
      margin: 1.5rem 0 2.5rem;
      padding: 1.5rem;
      border: 1px solid #e0e0e0;
      background: #fafafa;
    }

    .series-eyebrow {
      font-size: 0.75rem;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 0.4rem;
    }

    .series-title {
      font-family: 'Merriweather', serif;
      font-size: 1.5rem;
      color: #2c3e50;
      margin: 0;
    }

    .series-hero {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      margin: 0.75rem 0 1.2rem;
    }

    .series-cover {
      display: block;
      width: 20%;
      max-width: 520px;
      margin: 0;
      border: 1px solid #e0e0e0;
      background: #fff;
    }
    
    .series-blurb {
      flex: 1;
      margin: 0 0 0 20px;
      color: #888;
      font-size: 0.9rem;
      font-style: italic;
      line-height: 1.6;
      max-width: 400px;
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .series-blurb {
        margin: 0 0 0 0;
      }
    }

    .series-toc-title {
      margin-top: 0.9rem;
      font-size: 1rem;
      color: #2c3e50;
      font-weight: 600;
    }

    .series-toc {
      margin: 0.4rem 0 0 1.2rem;
    }

    .series-toc li {
      margin-bottom: 0.4rem;
    }

    .series-toc a {
      color: #2c3e50;
    }

    .series-toc .is-current a {
      color: #3c78d8ff;
      font-weight: 600;
    }

    /* Next post card */
    .next-post {
      margin-top: 3rem;
      padding-top: 2rem;
      border-top: 1px solid #e0e0e0;
    }
    
    .next-post-label {
      font-size: 0.9rem;
      color: #888;
      margin-bottom: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .next-post-card {
      display: block;
      text-decoration: none;
      color: inherit;
      padding: 1.5rem;
      border: 1px solid #e0e0e0;
      border-radius: 0;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .next-post-card:hover {
      border-color: #3c78d8ff;
      box-shadow: 0 2px 8px rgba(52, 152, 219, 0.1);
      transform: translateY(-2px);
    }
    
    .next-post-card::after {
      content: "→";
      position: absolute;
      right: 1.5rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.5rem;
      color: #3c78d8ff;
      transition: transform 0.3s ease;
      font-weight: bold;
    }
    
    .next-post-card:hover::after {
      transform: translateY(-50%) translateX(5px);
    }
    
    .next-post-images {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    
    .next-post-images img {
      height: 120px;
      width: auto;
      border-radius: 0;
      display: block;
    }

    @media (max-width: 768px) {
      .next-post-images img {
        height: 80px;
      }
    }
    
    .next-post-title {
      font-family: 'Merriweather', serif;
      font-size: 1.5rem;
      color: #2c3e50;
      margin: 0;
      padding-right: 2rem;
    }
    
    .next-post-card:hover .next-post-title {
      color: #3c78d8ff;
    }
    
    /* Print styles */
    @media print {
      body {
        background: #fff;
      }
      
      .container {
        max-width: 100%;
        padding: 0;
      }
      
      .next-post {
        display: none;
      }

      .series-nav {
        display: none;
      }
    }
    
  </style>

    
    
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
  <div class="container">
    <nav>
      <a href="../index.html">Home</a>
      <a href="https://github.com/umbralcalc">GitHub</a>
      <a href="../cv.html">CV</a>
    </nav>

        <section class="series-nav" id="series-nav" data-series-tag="Engineering Smart Actions in Practice" data-series-order="1">
      <div class="series-hero">
                <img class="series-cover" id="series-cover" src="https://pub-afdb1348ec964ca5b530aa758c0bdc56.r2.dev/assets/engineering-smart-actions-in-practice-cover.svg" alt="Engineering Smart Actions in Practice cover" onerror="this.style.display='none'" />
                        <p class="series-blurb">A collection of posts which apply tools for simulating real-world systems to solve various practical problems along the same theme of ‘selecting the best actions to take’. All data sources have been referenced in the relevant project code repositories. All written material and non-interactive diagrams were human-generated, where some interactive elements were programmed using generative AI tools.</p>
              </div>
      <div class="series-eyebrow">Collection</div>
      <h2 class="series-title">Engineering Smart Actions in Practice</h2>
      <ol class="series-toc" id="series-toc"></ol>
    </section>
    
    <main>
      <p>Work In Progress…</p>
      <h1 id="substitution-timing-of-rugby-managers">Substitution timing of rugby managers</h1>
      <div style="height:0.75em;">

      </div>
      <p>Project here: <a href="https://github.com/umbralcalc/trywizard">https://github.com/umbralcalc/trywizard</a>.</p>
      <center>
      <img src="https://pub-afdb1348ec964ca5b530aa758c0bdc56.r2.dev/assets/substitution_timing_of_rugby_managers/rugby-match-simulation.svg"/>
      </center>
      <script src="https://go-echarts.github.io/go-echarts-assets/assets/echarts.min.js"></script>
      <div class="echarts-container">
          <div class="echarts-item" id="sJENHIlOpeNh" style="width:100%;max-width:600px;height:350px;"></div>
      </div>
      <script type="text/javascript">
          "use strict";
          let goecharts_sJENHIlOpeNh = echarts.init(document.getElementById('sJENHIlOpeNh'), "white", { renderer: "canvas" });
          let option_KKGCKRjZWAgm = {"color":["#2c3e50","#3c78d8","#b0447a"],"legend":{"top":"30px"},"grid":{"top":"70px"},"series":[{"name":"try","type":"line","data":[{"value":[0,"0.0960"]},{"value":[1,"0.0938"]},{"value":[2,"0.0918"]},{"value":[3,"0.1022"]},{"value":[4,"0.1063"]},{"value":[5,"0.1090"]},{"value":[6,"0.1124"]},{"value":[7,"0.1090"]},{"value":[8,"0.1124"]},{"value":[9,"0.1109"]},{"value":[10,"0.1100"]},{"value":[11,"0.1100"]},{"value":[12,"0.1141"]},{"value":[13,"0.1136"]},{"value":[14,"0.1124"]},{"value":[15,"0.1166"]},{"value":[16,"0.1179"]},{"value":[17,"0.1166"]},{"value":[18,"0.1145"]},{"value":[19,"0.1138"]},{"value":[20,"0.1103"]},{"value":[21,"0.1083"]},{"value":[22,"0.1069"]},{"value":[23,"0.1130"]},{"value":[24,"0.1143"]},{"value":[25,"0.1113"]},{"value":[26,"0.1162"]},{"value":[27,"0.1148"]},{"value":[28,"0.1095"]},{"value":[29,"0.1048"]},{"value":[30,"0.1000"]},{"value":[31,"0.0965"]},{"value":[32,"0.0944"]},{"value":[33,"0.0965"]},{"value":[34,"0.0900"]},{"value":[35,"0.0880"]},{"value":[36,"0.0857"]},{"value":[37,"0.0846"]},{"value":[38,"0.0850"]},{"value":[39,"0.0840"]},{"value":[40,"0.0840"]},{"value":[41,"0.1000"]},{"value":[42,"0.1000"]},{"value":[43,"0.0988"]},{"value":[44,"0.0978"]},{"value":[45,"0.0947"]},{"value":[46,"0.1000"]},{"value":[47,"0.0981"]},{"value":[48,"0.1000"]},{"value":[49,"0.0981"]},{"value":[50,"0.1009"]},{"value":[51,"0.1009"]},{"value":[52,"0.1038"]},{"value":[53,"0.1000"]},{"value":[54,"0.1011"]},{"value":[55,"0.0984"]},{"value":[56,"0.1009"]},{"value":[57,"0.1024"]},{"value":[58,"0.0968"]},{"value":[59,"0.0991"]},{"value":[60,"0.0939"]},{"value":[61,"0.0968"]},{"value":[62,"0.0984"]},{"value":[63,"0.0983"]},{"value":[64,"0.0968"]},{"value":[65,"0.0992"]},{"value":[66,"0.1016"]},{"value":[67,"0.1052"]},{"value":[68,"0.1037"]},{"value":[69,"0.1022"]},{"value":[70,"0.0985"]},{"value":[71,"0.1000"]},{"value":[72,"0.0933"]},{"value":[73,"0.0954"]},{"value":[74,"0.0954"]},{"value":[75,"0.0912"]},{"value":[76,"0.0882"]},{"value":[77,"0.0870"]},{"value":[78,"0.0874"]},{"value":[79,"0.0874"]},{"value":[80,"0.0870"]},{"value":[81,"0.0874"]},{"value":[82,"0.0856"]},{"value":[83,"0.0847"]},{"value":[84,"0.0813"]},{"value":[85,"0.0900"]}]},{"name":"penalty goal","type":"line","data":[{"value":[0,"0.0253"]},{"value":[1,"0.0250"]},{"value":[2,"0.0235"]},{"value":[3,"0.0233"]},{"value":[4,"0.0221"]},{"value":[5,"0.0220"]},{"value":[6,"0.0219"]},{"value":[7,"0.0220"]},{"value":[8,"0.0219"]},{"value":[9,"0.0209"]},{"value":[10,"0.0225"]},{"value":[11,"0.0225"]},{"value":[12,"0.0207"]},{"value":[13,"0.0207"]},{"value":[14,"0.0200"]},{"value":[15,"0.0221"]},{"value":[16,"0.0228"]},{"value":[17,"0.0214"]},{"value":[18,"0.0207"]},{"value":[19,"0.0200"]},{"value":[20,"0.0207"]},{"value":[21,"0.0207"]},{"value":[22,"0.0200"]},{"value":[23,"0.0174"]},{"value":[24,"0.0162"]},{"value":[25,"0.0148"]},{"value":[26,"0.0133"]},{"value":[27,"0.0139"]},{"value":[28,"0.0143"]},{"value":[29,"0.0162"]},{"value":[30,"0.0153"]},{"value":[31,"0.0141"]},{"value":[32,"0.0144"]},{"value":[33,"0.0141"]},{"value":[34,"0.0138"]},{"value":[35,"0.0147"]},{"value":[36,"0.0157"]},{"value":[37,"0.0154"]},{"value":[38,"0.0167"]},{"value":[39,"0.0120"]},{"value":[40,"0.0120"]},{"value":[41,"0.0240"]},{"value":[42,"0.0225"]},{"value":[43,"0.0212"]},{"value":[44,"0.0211"]},{"value":[45,"0.0211"]},{"value":[46,"0.0210"]},{"value":[47,"0.0210"]},{"value":[48,"0.0210"]},{"value":[49,"0.0210"]},{"value":[50,"0.0227"]},{"value":[51,"0.0227"]},{"value":[52,"0.0200"]},{"value":[53,"0.0168"]},{"value":[54,"0.0168"]},{"value":[55,"0.0192"]},{"value":[56,"0.0191"]},{"value":[57,"0.0192"]},{"value":[58,"0.0192"]},{"value":[59,"0.0200"]},{"value":[60,"0.0209"]},{"value":[61,"0.0200"]},{"value":[62,"0.0216"]},{"value":[63,"0.0217"]},{"value":[64,"0.0216"]},{"value":[65,"0.0216"]},{"value":[66,"0.0216"]},{"value":[67,"0.0200"]},{"value":[68,"0.0215"]},{"value":[69,"0.0215"]},{"value":[70,"0.0222"]},{"value":[71,"0.0232"]},{"value":[72,"0.0215"]},{"value":[73,"0.0215"]},{"value":[74,"0.0215"]},{"value":[75,"0.0216"]},{"value":[76,"0.0200"]},{"value":[77,"0.0190"]},{"value":[78,"0.0168"]},{"value":[79,"0.0168"]},{"value":[80,"0.0190"]},{"value":[81,"0.0168"]},{"value":[82,"0.0178"]},{"value":[83,"0.0176"]},{"value":[84,"0.0175"]},{"value":[85,"0.0157"]}]},{"name":"yellow card","type":"line","data":[{"value":[0,"0.0093"]},{"value":[1,"0.0112"]},{"value":[2,"0.0106"]},{"value":[3,"0.0100"]},{"value":[4,"0.0095"]},{"value":[5,"0.0090"]},{"value":[6,"0.0086"]},{"value":[7,"0.0090"]},{"value":[8,"0.0086"]},{"value":[9,"0.0091"]},{"value":[10,"0.0117"]},{"value":[11,"0.0117"]},{"value":[12,"0.0126"]},{"value":[13,"0.0121"]},{"value":[14,"0.0117"]},{"value":[15,"0.0145"]},{"value":[16,"0.0145"]},{"value":[17,"0.0152"]},{"value":[18,"0.0159"]},{"value":[19,"0.0152"]},{"value":[20,"0.0159"]},{"value":[21,"0.0159"]},{"value":[22,"0.0152"]},{"value":[23,"0.0174"]},{"value":[24,"0.0190"]},{"value":[25,"0.0174"]},{"value":[26,"0.0143"]},{"value":[27,"0.0165"]},{"value":[28,"0.0181"]},{"value":[29,"0.0190"]},{"value":[30,"0.0212"]},{"value":[31,"0.0188"]},{"value":[32,"0.0178"]},{"value":[33,"0.0176"]},{"value":[34,"0.0163"]},{"value":[35,"0.0173"]},{"value":[36,"0.0171"]},{"value":[37,"0.0185"]},{"value":[38,"0.0200"]},{"value":[39,"0.0160"]},{"value":[40,"0.0160"]},{"value":[41,"0.0173"]},{"value":[42,"0.0187"]},{"value":[43,"0.0176"]},{"value":[44,"0.0178"]},{"value":[45,"0.0179"]},{"value":[46,"0.0200"]},{"value":[47,"0.0190"]},{"value":[48,"0.0200"]},{"value":[49,"0.0190"]},{"value":[50,"0.0182"]},{"value":[51,"0.0182"]},{"value":[52,"0.0181"]},{"value":[53,"0.0168"]},{"value":[54,"0.0158"]},{"value":[55,"0.0160"]},{"value":[56,"0.0148"]},{"value":[57,"0.0144"]},{"value":[58,"0.0152"]},{"value":[59,"0.0148"]},{"value":[60,"0.0148"]},{"value":[61,"0.0152"]},{"value":[62,"0.0136"]},{"value":[63,"0.0130"]},{"value":[64,"0.0128"]},{"value":[65,"0.0136"]},{"value":[66,"0.0128"]},{"value":[67,"0.0148"]},{"value":[68,"0.0163"]},{"value":[69,"0.0163"]},{"value":[70,"0.0148"]},{"value":[71,"0.0152"]},{"value":[72,"0.0141"]},{"value":[73,"0.0138"]},{"value":[74,"0.0138"]},{"value":[75,"0.0120"]},{"value":[76,"0.0136"]},{"value":[77,"0.0150"]},{"value":[78,"0.0147"]},{"value":[79,"0.0147"]},{"value":[80,"0.0150"]},{"value":[81,"0.0147"]},{"value":[82,"0.0144"]},{"value":[83,"0.0153"]},{"value":[84,"0.0150"]},{"value":[85,"0.0143"]}]}],"title":{"text":"Smoothed baseline event rates per minute"},"toolbox":{},"tooltip":{"trigger":"item","formatter":"({c})"},"xAxis":[{"name":"minute"}],"yAxis":[{}]};

          goecharts_sJENHIlOpeNh.setOption(option_KKGCKRjZWAgm);
          window.addEventListener('resize', function() { goecharts_sJENHIlOpeNh.resize(); });
      </script>
      <style>
          .echarts-container {margin-top:30px; display: flex;justify-content: center;align-items: center;}
          .echarts-item {margin: auto;}
      </style>
      
            <div class="next-post">
        <div class="next-post-label">Next Post</div>
        <a href="/posts/how_sustainable_are_freshwater_fishing_policies_in_the_uk.html" class="next-post-card">
                    <div class="next-post-images" id="next-post-images"></div>
                    <div class="next-post-title">How sustainable are freshwater fishing policies in the UK?</div>
        </a>
      </div>
          </main>
  </div>
  
    <script>
    // Parse and display next post images
    (function() {
      const imagesContainer = document.getElementById('next-post-images');
      if (imagesContainer) {
        try {
          const imagesJson = '[]';
          const images = JSON.parse(imagesJson);
          if (Array.isArray(images) && images.length > 0) {
            images.forEach(imagePath => {
              const img = document.createElement('img');
              img.src = imagePath;
              img.alt = 'How sustainable are freshwater fishing policies in the UK?';
              imagesContainer.appendChild(img);
            });
          }
        } catch (e) {
          console.error('Error parsing next post images:', e);
        }
      }
    })();
  </script>
  
  <script>
    // Build series navigation for collections
    (function() {
      const seriesNav = document.getElementById('series-nav');
      if (!seriesNav) {
        return;
      }

      const seriesTag = seriesNav.dataset.seriesTag;
      if (!seriesTag || seriesTag === 'Loose Threads') {
        return;
      }

      const currentSlug = (window.location.pathname.split('/').pop() || '')
        .replace('.html', '')
        .trim();

      fetch('/posts.json')
        .then(response => response.json())
        .then(posts => {
          const seriesPosts = posts
            .filter(post => post.tag === seriesTag)
            .sort((a, b) => {
              const orderA = a.order !== undefined ? a.order : 999;
              const orderB = b.order !== undefined ? b.order : 999;
              if (orderA !== orderB) {
                return orderA - orderB;
              }
              return (a.title || '').localeCompare(b.title || '');
            });

          if (seriesPosts.length === 0) {
            seriesNav.style.display = 'none';
            return;
          }

          const currentIndex = seriesPosts.findIndex(post => {
            if (post.slug && post.slug === currentSlug) {
              return true;
            }
            if (post.url && currentSlug) {
              return post.url.endsWith(`/posts/.html`);
            }
            return false;
          });

          const toc = document.getElementById('series-toc');
          if (toc) {
            seriesPosts.forEach((post, index) => {
              const item = document.createElement('li');
              if (index === currentIndex) {
                item.classList.add('is-current');
              }
              const link = document.createElement('a');
              link.href = post.url;
              link.textContent = post.title || post.slug || 'Untitled';
              item.appendChild(link);
              toc.appendChild(item);
            });
          }
        })
        .catch(error => {
          console.error('Error loading posts for series navigation:', error);
        });
    })();
  </script>
</body>
</html>
